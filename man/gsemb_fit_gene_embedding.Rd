% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/embedding.R
\name{gsemb_fit_gene_embedding}
\alias{gsemb_fit_gene_embedding}
\title{Fit a gene embedding from diffusion features}
\usage{
gsemb_fit_gene_embedding(
  node_features,
  dim = 64,
  method = c("torch_autoencoder", "svd"),
  epochs = 50,
  lr = 0.001,
  batch_size = 256,
  seed = 1,
  device = c("cpu", "cuda")
)
}
\arguments{
\item{node_features}{Numeric matrix with nodes in rows and features in columns.
Row names must be node IDs.}

\item{dim}{Embedding dimension.}

\item{method}{`"svd"` or `"torch_autoencoder"`.}

\item{epochs}{Number of epochs for the torch autoencoder.}

\item{lr}{Learning rate for the torch autoencoder.}

\item{batch_size}{Batch size for the torch autoencoder.}

\item{seed}{Random seed.}

\item{device}{`"cpu"` or `"cuda"` (falls back to CPU if CUDA is unavailable).}
}
\value{
A list with components `embedding` (numeric matrix) and `method`.
  When `method="torch_autoencoder"`, the fitted `model` is also returned.
}
\description{
Reduce node diffusion feature vectors into a lower-dimensional embedding using
either SVD (CPU) or a simple torch autoencoder.
}
