% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/set2gaussian_torch.R
\name{gsemb_fit_set2gaussian_torch}
\alias{gsemb_fit_set2gaussian_torch}
\title{Train Set2Gaussian embeddings with torch}
\usage{
gsemb_fit_set2gaussian_torch(
  adj,
  gene_sets,
  landmarks = NULL,
  k = 128,
  dim = 64,
  alpha = 0.5,
  tol = 1e-10,
  max_iter = 200,
  normalize = "col",
  tau = 1,
  lambda_set = 1,
  epochs = 200,
  lr = 0.005,
  batch_size = 8,
  seed = 1,
  device = c("cpu", "cuda")
)
}
\arguments{
\item{adj}{Adjacency matrix with node IDs in rownames.}

\item{gene_sets}{Named list of character vectors (gene IDs).}

\item{landmarks}{Optional landmark IDs; selected by degree if `NULL`.}

\item{k}{Number of landmarks when `landmarks` is `NULL`.}

\item{dim}{Embedding dimension.}

\item{alpha}{Restart probability for diffusion.}

\item{tol}{Convergence tolerance for diffusion.}

\item{max_iter}{Maximum diffusion iterations.}

\item{normalize}{Normalization for `gsemb_transition_matrix`.}

\item{tau}{Softmax temperature used in distribution matching.}

\item{lambda_set}{Weight for the set-level loss term.}

\item{epochs}{Number of optimization epochs.}

\item{lr}{Learning rate.}

\item{batch_size}{Batch size for sampling landmarks/sets per epoch.}

\item{seed}{Random seed.}

\item{device}{`"cpu"` or `"cuda"` (falls back to CPU if CUDA is unavailable).}
}
\value{
A list with `gene_embedding`, `set_mu`, `set_var`, `landmarks`, and `losses`.
}
\description{
Learn a gene embedding (points) and gene set embeddings (diagonal Gaussians)
by matching diffusion distributions from landmarks and gene sets.
}
